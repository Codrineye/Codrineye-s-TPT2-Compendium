# Fragzilla originally made by Florin_TK on [discord](https://discord.com/channels/488444879836413975/1223940533844705320)

Source code of Fragzilla is to be imported in [perfect-tower by d0sboots](https://d0sboots.github.io/perfect-tower/)

## Changelog

### Version 2.1
- Minor performance improvements by changing goto(if)'s to gotoif()'s
- You can now change the impulse keys from the library
- Replaced macros that just had strings with :const string definitions

## Version 2

Version 2 consists of 1 script with 21 actions.<br>
The files can be found in [version 2 folder](version%202/WS.Fragzilla_lib.tpt2).

```
{"workspaces":{"Fragment Automation":[["WSFrag",":import WS.Fragzilla_lib\n; we import the library\n; it's pretty bland, but it's still nice organization\n\n:budget_cap -1\n:name {package(WSFrag)}\n; set the script to run as fast as possible\n; set its name\n\n:local double cooldown\n:local int hammer_count\n:local int remClicks\n\nkey.{start}()\nkey.{hide}()\n\n; local doubles for the user to configure the script\n; cooldown is how much time to wait in the idle screen\ncooldown = 1.1\n\n; hammer_count is how many times the script\n; should click the hammer before going back on cooldown\nhammer_count = 1\n\n; \n; we start the script by determening the state\n; if all windows are closed, we toggle our status\n; otherwise, the status is always off\n; \n; this is a clean script shut down/wakeup operation\n\n{status.set(if({contains.key({hide})}, \"\", if(\\\n  anyopen() || {script.active}, \\\n  status.off, \\\n  status.on\\\n)))}\n\n; blocker condition that ensures we only\n; interact with the game when not shut down\ngotoif(quit, not({script.active}))\n\nhammer:\n; this is the hammer chunk\n; if the user has activated the script\n; then we must already be on floor 2\n\nshow(\"workshop\", true)\n; we enter the workshop, as that's where the hammer button is\nwaitframe()\n; and wait a frame for the action to be performed\n\nremClicks = hammer_count\n; now, create a copy of the hammer_count and\n; enter the hammering loop\n\nhammer_time:\nremClicks = remClicks - 1\n\n{click.relative(720.0/800.0, 40.0/450.0, 0.5, 0.5)}\nwaitframe()\n\n; we click in the location of the hammer button\n; and wait a frame so that the operation is processed\n\ngotoif(hammer_time, remClicks > 0)\n; we keep itterating until remClicks is <= 0\n\nshow(\"workshop\", false)\nwaitframe()\n; then, end this chunk by exiting the workshop\n; and waitframe() for the action to be processed\n\ngotoif(quit, not({script.active}))\n; a secondary gotoif() blocker to ensure we quit when shut down\n\nfarm:\n; this is the farm chunk\n; while in here, we wait in the idle screen\n; for our cooldown to run out\n\nshow(\"towertesting\", true)\nwaitframe()\n; to enter idle mode, we must have\n; the towertesting window open\n\n{click.relative(90.0/800.0, 35.0/450.0, 0.0, 0.0)}\nwait(cooldown)\n; and we click on the position where the button that\n; opens the idle screen is shown\n; \n; because it's useless for the cooldown to be 0.0\n; wait(0.0) moves so fast that the click isn't registered\n; (unless you have a budget <= 100)\n; so we can exit the towertesting window without any issues\n\nshow(\"towertesting\", false)\nwaitframe()\n\n; and the end of the hammer chunk ensures we return to hammer\n; only if the script isn't shut down\ngotoif(hammer, {script.active})\n\nquit:"],["WS.Fragzilla_lib","#version 2.1\n#package(name) <color=#6AF>WS.Fragzilla:{name} v{version}</color>\n; script version and name\n; version, in case there's further updates to it\n; script name, for ease of use\n\n#start f\n#hide h\n\n\n#identifier WSFrag\n; script identifier, to create script-unique global variable names\n:const string status \"<size=0>{identifier} status\"\n; global name variable for the scripts status\n\n#status.get global.string.get(status)\n#status.set(value) global.string.set(status, \"</size>\" . {value})\n\n\n#status.color(color, info) \"<color={color}>{info}</color>\"\n; helper macro to more easily define status colors and contents\n\n:const string status.on {status.color(#0F0, {identifier} is running)}\n:const string status.off {status.color(#F00, {identifier} is offline)}\n; the status strings\n\n#contains.key(key) contains(impulse(), \"key.{key}\")\n; helper macro to shorten the contains() operation for\n; checking the scripts triggered impulse\n\n#script.active contains({status.get}, status.on)\n; helper macro that checks if the script is active\n\n\n; guide for size\n;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\n; just in case I have to do things with this on my laptop\n"]]}}
```

## Version 1

Source kept for archival, so that people (myself included) can see the atrocites I made with this script.<br>
The files can be found in [version 1 folder](version%201/fragments_lib.tpt2).

```
{"workspaces":{"Fragment Automation":[["fragments_lib","; name of the package\n#package(name) WS.Fragzilla:{name}\n\n; enter idle mode or anvil mode\n; \"IA\" = idle or anvil = 0 or 1\n#mode \"<size=0>Mode\"\n\n"],["Init",":import fragments_lib\n:name {package(Init)}\n\n:global string variables\n:global bool running\n:local int keeper\n\nkey.f()\n\nfalse == anyopen()\n\ngotoif(exit, running)\ngis({mode}, if(\\\n  variables == \"\", \\\n  -1, \\\n  gig({mode})\\\n))\nrunning = true\nvariables = concat(\"cooldown=\", \"1.1\") . \",\" . concat(\"hammercount=\", \"1\") . \"</size=0>\"\n\nexecutesync(\"{package(Floor Detection)}\")\nexecute(\"{package(Farm)}\")\nexecute(\"{package(Hammer)}\")\n\ngoto(99)\n\nexit:\nrunning = false\n"],["Floor Detection",":import fragments_lib\n\n:name {package(Floor Detection)}\n:local bool floor\n; program to detect if is floor 2 or floor 1\n\ngotoif(99, gig({mode}) != -1)\n\nshow(\"towertesting\", true)\n\n{click.relative(162.0/800.0, 97.0/450.0, 0.0, 1.0)} ;launch round\nwaituntil(isTowerTesting())\nquit:\nexit()\ngotoif(quit, isTowerTesting())\nwait(0.5) ;wait for everything to load up\n\nshow(\"workshop\", true) ;enter workshop\n\n{click.relative(215.0/800.0, 35.0/450.0, 0.0, 0.0)}  ;click on floor 2\n{click.relative(148.0/800.0, 325.0/450.0, 0.5, 0.5)} ;ensure it's infinity tab sellected\n{click.relative(380.0/800.0, 47.0/450.0, 0.0, 0.0)} ;enter anvil mode\n\n"],["Farm",":import fragments_lib\n:name {package(Farm)}\n\n:global string variables\n:global bool running\n\ngotoif(if(running, 1, 99), global.int.get({mode}) == 1)\n\nshow(\"workshop\", false)\nshow(\"towertesting\", true)\n\n{click.relative(90.0/800.0, 35.0/450.0, 0.0, 0.0)}\n\nwait(s2d(sub(variables, 9, index(variables, \",\", 9) - 9), 3.0))\n\nglobal.int.set({mode}, 1)\ngotoif(1, running)\n"],["Hammer",":import fragments_lib\n:name {package(Hammer)}\n\n:global string variables\n:global bool running\n:local int remClicks\n\ngotoif(if(running, 1, 99), gig({mode}) != 1)\n\nshow(\"towertesting\", false)\nshow(\"workshop\", true)\n\nremClicks = 1 + s2i(\\\n  sub(\\\n    variables, \\\n    index(variables, \"hammercount=\", 0), \\\n    index(variables, \"</\", 0) - index(variables, \"hammercount=\", 0)\\\n  ), \\\n  3\\\n)\n\nhammertime:\nremClicks = remClicks - 1\n{click.relative(720.0/800.0, 40.0/450.0, 0.5, 0.5)}\ngotoif(hammertime, remClicks > 0)\n\nglobal.int.set({mode}, 0)\ngotoif(0, running)\n"]]}}
```
