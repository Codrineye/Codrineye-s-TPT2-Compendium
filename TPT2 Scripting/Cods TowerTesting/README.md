# Codrineye's TowerTesting
My first public project which got me to create this entire repo

It returns, but this time, it's with better logic<br>
There are 2 versions in this repo, [Codrineye's TowerTesting](#codrineyes-towertesting-v-10) and [Cod TT](#cod-tt)

# Source Code
The source code is a code you import into the [external AI editor](https://d0sboots.github.io/perfect-tower/) by [d0sboots](https://github.com/d0sboots/perfect-tower)
```
{"workspaces":{"Cods TowerTesting":[["TowerTesting_lib","#version v1.2.7\n#package(name) Cods TowerTesting {version}:{name}\n\n#identifier \"Condineye's TowerTesting\"\n\n#hider concat(\"<size=0>\", \"Variable_Hider\") . {identifier}\n\n#state \"<size=0>\" . {identifier} . \"</size>\" . \"active\"\n#state_get global.bool.get({state})\n#state_toggle global.bool.set({state}, false == {state_get})\n\n#counting \"<size=0>\" . {identifier} . \"counting\"\n#counting_get global.int.get({counting})\n#counting_set(value) global.int.set({counting}, ({value}))\n#counting_increment {counting_set({counting_get} + 1)}\n\n#change_difficulty \"<size=0>\" . {identifier} . \"</size>\" . \"change_difficulty\"\n#change_difficulty_get global.bool.get({change_difficulty})\n#change_difficulty_set(value) global.bool.set({change_difficulty}, {value})\n\n#Region_Cycling {identifier} . \"</size>\" . \"Region_Cycling\"\n#Region_Cycling_get global.bool.get({Region_Cycling})\n\n#mode1 \"Difficulty>Region\" . \"</size>\"\n#mode2 \"Region>Difficulty\" . \"</size>\"\n\n:const int difficulty_spacing 5\n\n:const string difficulty1 '290.0'\n:const string difficulty2 '256.0'\n:const string difficulty3 '217.0'\n:const string difficulty4 '182.0'\n:const string difficulty5 '145.0'\n:const string difficulty6 '112.0'\n\n:const int difficulty_count 6\n\n#difficulty_list difficulty1 . difficulty2 . difficulty3 . difficulty4 . difficulty5 . difficulty6\n#inversed_difficulty_list difficulty6 . difficulty5 . difficulty4 . difficulty3 . difficulty2 . difficulty1\n\n"],["Stats Exit Diff_Change",":import TowerTesting_lib\n:name {package(Stats Exit Diff_Change)}\n\n:global double Curent_Diff\n:local int increment\n\nkey.t()\nkey.e()\n\nconcat(\"Easy -> Impossible\", {difficulty_list}) != \\\nconcat(\"Impossible -> Easy\", {inversed_difficulty_list})\n\ngoto(if(\\\n  contains(impulse(), \"{package()}\"), \\\n  loop, \\\n  if(\\\n    contains(impulse(), \"key.\"), \\\n    if(\\\n      isTowerTesting(), \\\n      if(contains(impulse(), \"key.t\"), stats, exit), \\\n      99\\\n    ), \\\n    wait_for_exit\\\n  )\\\n))\nwait_for_exit:\nwaitwhile(global.double.get(\"t\") % 60.0 > 0.5 || global.double.get(\"t\") < 0.5)\nexit:\nexit()\n\nstats:\nwait(screen_delay)\n{click.relative(230.0/800.0, 275.0/450.0, 0.5, 0.5)}\ngoto(99)\n\nloop:\nCurent_Diff = s2d(sub({difficulty_list}, increment * difficulty_spacing, difficulty_spacing), 290.0)\n\nincrement = (increment + 1) % difficulty_count\n\nwait(screen_delay)\nwaituntil({change_difficulty_get} || {state_get} == false)\n{change_difficulty_set(false)}\n\ngotoif(loop, {state_get})\n"],["Toggles",":import TowerTesting_lib\n:name {package(Toggles)}\n\n:global string CurentMode\n\nkey.q()\nkey.w()\n\ngotoif(initialized, {state_get})\nexecutesync(\"{package(Initialiser)}\")\ngoto(99)\n\ninitialized:\nglobal.bool.set(\\\n  {Region_Cycling}, \\\n  contains(\"key.q|{package(Initialiser)}\", impulse()) || {Region_Cycling_get} == false\\\n)\n\ngotoif(99, contains(impulse(), \"key.w\"))\nCurentMode = if(\\\n  contains(CurentMode, {mode1}) && false == contains(impulse(), \"{package()}\"), \\\n  {mode2}, \\\n  {mode1}\\\n)\n"],["Enter Region",":import TowerTesting_lib\n:name {package(Enter Region)}\n\n:global double Curent_Diff\n:global string CurentMode\n\n#condition1 contains(CurentMode, {mode2}) && {counting_get} == 14\n#condition2 contains(CurentMode, {mode1}) && {counting_get} < 6\n\ngotoif(if({state_get}, enter_difficulty, 99), {condition1} || {condition2})\ngotoif(enter_difficulty, false == {Region_Cycling_get})\n\nwaitwhile(isTowerTesting() || anyopen())\n\nshow(\"towertesting\", true)\nwait(global.double.get(\"screen_delay\"))\n{click.relative(290.0/800.0, 201.0/450.0, 0.0, 1.0)}\nwait(global.double.get(\"screen_delay\"))\n\nenter_difficulty:\nshow(\"towertesting\", true)\nwait(global.double.get(\"screen_delay\"))\n{click.relative(395.0/800.0, Curent_Diff/450.0, 0.0, 1.0)}\n\nwait(global.double.get(\"screen_delay\"))\n{click.relative(162.0/800.0, 97.0/450.0, 0.0, 1.0)}\n"],["Movement Manager",":import TowerTesting_lib\n:name {package(Movement Manager)}\n\n:global string CurentMode\n\n{counting_set(0)}\n{change_difficulty_set(false)}\n\nloop:\nwaitwhile({state_get} && (anyopen() || isTowerTesting() || CurentMode == \"\"))\nexecutesync(\"{package(Enter Region)}\")\n\n{counting_increment}\n{change_difficulty_set(contains(CurentMode, {mode1}))}\n\nwaitwhile({change_difficulty_get} && {state_get})\nwaituntil(anyopen() || isTowerTesting() || {state_get} == false)\ngotoif(\\\n  if({state_get}, loop, 99), \\\n  contains(CurentMode, {mode1}) && {counting_get} < 6 || \\\n  contains(CurentMode, {mode2}) && {counting_get} < 15\\\n)\nwaitwhile({state_get} && (anyopen() || isTowerTesting()))\nexecutesync(\"{package(Enter Region)}\")\n\n{counting_set(0)}\n{change_difficulty_set(contains(CurentMode, {mode2}))}\ngotoif(loop, {state_get})\n"],["Initialiser",":import TowerTesting_lib\n:name {package(Initialiser)}\n\nkey.x()\n\n:local bool additional_cond\n\nadditional_cond = false\nglobal.string.set({hider}, if(\\\n  {state_get}, \\\n  \"Codrineye's TowerTesting Is Shutdown\", \\\n  concat(\"Hider Blocker\", \"</size>\")\\\n))\n\n{state_toggle}\ngoto(if({state_get}, skip, 99))\n\nskip:\nexecute(\"{package(Stats Exit Diff_Change)}\")\nexecute(\"{package(Movement Manager)}\")\nexecutesync(\"{package(Toggles)}\")\nwaitwhile({state_get} && (anyopen() || isTowerTesting()))\n\nloop:\nwaitwhile({state_get} && (isTowerTesting() == false))\nexecute(\"{package(Restart At Will)}\")\nwaitwhile({state_get} && health(false) > 0.0 && (additional_cond == false) && (enemies() > 0 || wave() < 100.0))\nexit:\nexit()\ngotoif(exit, isTowerTesting())\nstop(\"{package(Restart At Will)}\")\ngotoif(loop, {state_get})\n\n"],["Restart At Will",":import TowerTesting_lib\n:name {package(Restart At Will)}\n\nkey.r()\n\nglobal.double.set(\"screen_delay\", 0.5)\ngotoif(restart, contains(impulse(), \"key.\"))\nwait(30.0)\n\nrestart:\nrestart()"]]}}
```
# Cods TowerTesting v 1.2.7
This reintroduces `Restart At Will` as a separate script, as the way it functions doesn't permit it being merged in other scripts<br>
Added a loop to the exit so that the game can properly exit towertesting if the condition in `aditional_cond` returns true faster than the exut function can be used<br>
Added new global variable `screen_delay` that can be edited at the top of [Restart At Will](/TPT2%20Scripting/Cods%20TowerTesting/Restart%20At%20Will)

# Cods TowerTesting v 1.2.5
This fixes the bug I missed when merging `Restart At Will` with `Initialiser`<br>
timer is now found in `Enter Region`<br>
Added local bool variable `additional_cond` to make aditional exit conditions easier to implement<br>
Imagine you want to implement an exit condition so that once you reach inf 1 you just need to make additional_cond = comparison.double game.infinity == 0

# Codrineye's TowerTesting v 1.2.2
This marks a rebranding as Cods TowerTesting<br>
Codrineye is too long, so from now on `Codrineye` will be shortened to `Cods`

# Codrineye's TowerTesting v 1.2.1
This version adds a couple bug fixes, removes the unnecessary shutdown message, implements unfinished assets and merges Restart At Will with Initialiser

# Codrineye's TowerTesting v 1.1.0
This version makes a slight difference to [Stats Exit Diff_Change](Stats%20Exit%20Diff_Change.tpt2) that supports it being used by [winAI4](/TPT2%20Scripting/Codrineye's%20Compact%20Spell-Caster/tick.tpt2) to exit towertesting once the round has lasted for 60 ingame seconds

# Codrineye's TowerTesting v 1.0.0
Codrineye's TowerTesting is a fully automated AI which will cycle through every single Region and Difficulty in accordance to both its Mode and wether or not its cycling mechanic is toggled on.


# Cod TT
Thank you bluecat for making an attempt to rework this mess

Cod TT is a version of Codrineye's TowerTesting made by bluecat, who tried to take my original idea and condense it into a more compact AI.<br>
While the attempt was great, and it lead to a functional product, it still has the same shortcomings my original AI had

```
{"workspaces":{"Cod TT":[["Tower_Automation lib","\n#package Codrineye's TowerTesting\n\n\n#init Init\n#logic Core\n#difficulty Difficulty Cycle\n#region Region Cycle\n#toggles QOL\n"],["init","\n:import Tower_Automation lib\n:name {package}:{init}\n\n:global bool CdTTRunning\n:global bool RegionCycle\n:global double ClickPos\n:global string difficultyClickPositions\n\n\n\nkey.x()\n\nstart:\ngss(\"OnName\", \"<color=#FF0000><b>PLEASE INPUT CUSTOM NAME IN HERE</b></color>\")\ngss(\"<size=0>\", \"##--STARTHIDING--##\")\nCdTTRunning = CdTTRunning == false ;starts true, if called again goes false and ends script\nRegionCycle = RegionCycle\nClickPos = ClickPos\ndifficultyClickPositions = \"112.0;145.0;182.0;217.0;256.0;290.0;</size><color=\" . if(CdTTRunning, \"#00FF00\", \"#FF0000\") . \">\" \ngss(gsg(\"OnName\") . if(false, \"\", \"<size=0>\"), \"</size></color><color=\" . if(RegionCycle, \"#FF0000\", \"#00FF00\"))\ngss(\"Cycle Region<size=0>\", \"</size>\")\nloop:\nexecutesync(\"{package}:{logic}\")\nwaituntil((tower.health(false) == 0.0) && isTowerTesting())\nexit()\ngotoif(loop, CdTTRunning)\ngu(gsg(\"OnName\"))"],["Instant Restart || Stats Button","\n:import Tower_Automation lib\n:name {package}:{toggles}\n\nkey.r() ;restart\nkey.t() ;stats\n\nisTowerTesting()\n\ngotoif(stats, impulse() == \"key.t\")\n\nrestart:\nrestart()\n\nstats:\n{click.relative(230.0/800.0, 275.0/450.0, 0.5, 0.5)}"],["Region Cycle Toggle || Region Move","\n:import Tower_Automation lib\n:name {package}:{region}\n\n:global bool CdTTRunning\n:global bool RegionCycle\n\nkey.w() ; toggle cycle\n\n\ngotoif(toggleCycle, contains(impulse(), \"key.\") || CdTTRunning == false)\n\nmoveRegion:\nwaitwhile(isTowerTesting() && RegionCycle)\ngotoif(99, RegionCycle == false)\nshow(\"towertesting\", true)\nwait(0.2)\n{click.relative(290.0/800.0, 201.0/450.0, 0.0, 1.0)}\nwait(0.2)\nshow(\"towertesting\", false)\ngoto(99)\n\ntoggleCycle:\nRegionCycle = (RegionCycle == false)\n"],["Difficulty Move || Auto Exit","\n:import Tower_Automation lib\n:name {package}:{difficulty}\n\n:global double ClickPos\n\ngame.newround()\nkey.e()\n\ngotoif(changeDiff, contains(impulse(), \"{package}\"))\n\nexit:\nwait(if(impulse() == \"game.newround\", 10.0, 0.0))\nexit()\ngoto(99)\n\nchangeDiff:\nshow(\"towertesting\", true)\nwait(0.2)\n{click.relative(395.0/800.0, ClickPos/450.0, 0.0, 1.0)}\nwait(0.2)\n{click.relative(162.0/800.0, 97.0/450.0, 0.0, 1.0)}\n"],["Movement Logic","\n:import Tower_Automation lib\n:name {package}:{logic}\n\n#subList sub(difficultyClickPositions, index, index(difficultyClickPositions, \";\", index) - index)\n\n:global double ClickPos\n:local int index\n:global string difficultyClickPositions\n\n\n\ngotoif(99, false)\nloop:\nwaitwhile(isTowerTesting()) \n; waits until the restart triggers from auto restart\n\nClickPos = s2d({subList}, 290.0) \n; sets the new position to go to diff\n    \nexecutesync(\"{package}:{difficulty}\") \n; runs position\n    \nindex = (index(difficultyClickPositions, \";\", index) + 1) \n; updates index to set up next click\n    \nwaituntil(isTowerTesting()) \n; run waituntil to make sure we get in TT before updating region if needed\n\nrepeat:\ngotoif(loop, {subList} != \"\") ; if next click is blank, list is over so lets restart\nexecutesync(\"{package}:{region}\") ; when there's no diffs start the region move\nlu(\"index\") ; remove this once I fix index\ngoto(loop)\n\n\n\n\n"]]}}
```
