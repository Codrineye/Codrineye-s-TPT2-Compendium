# Codrineye's TowerTesting
My first public project which got me to create this entire repo

It returns, but this time, it's with better logic<br>
There are 2 versions in this repo, [Codrineye's TowerTesting](#codrineyes-towertesting-v-10) and [Cod TT](#cod-tt)

# Codrineye's TowerTesting v 1.0.0
Codrineye's TowerTesting is a fully automated AI which will cycle through every single Region and Difficulty in accordance to both its Mode and wether or not its cycling mechanic is toggled on.

# Codrineye's TowerTesting v 1.1.0
This version makes a slight difference to [Stats Exit Diff_Change](Stats%20Exit%20Diff_Change.tpt2) that supports it being used by [winAI4](/TPT2%20Scripting/Codrineye's%20Compact%20Spell-Caster/tick.tpt2) to exit towertesting once the round has lasted for 60 ingame seconds

# Codrineye's TowerTesting v 1.2.1
This version adds a couple bug fixes, removes the unnecessary shutdown message, implements unfinished assets and merges Restart At Will with Initialiser

# What the AI does
On startup you will activate every global variable, the state of the script, the double Curent_Diff representing which difficulty will be entered, here's the list:<br>
- 290 is Easy
- 256 is Normal
- 217 is Hard
- 182 is Insane
- 145 is Nightmare
- 112 is Impossible

The boolean Region_Cycling representing if the AI will cycle through regions or not, and CurentMode, which has the modes `Difficulty>Region` meaning that the AI will first cycle through difficulties before changing regions, and `Region>Difficulty` meaning that the AI will first cycle through regions before changing difficulties.<br>
If you'd like to change the order the AI enters difficulties, I've put a condition which gives you the list for Easy->Impossible (the default configuration) and Impossible->Easy, you can find this list in the script called `Stats|Exit|Diff_Change` and you need to paste it in 

# The impulses
You can use x, q and w to start the AI and you can shut down the AI overlay with F4 or press x again.<br>
After startup, pressing q will cycle between the 2 modes previously mentioned, each time you change the mode your Region_Cycling will be toggled on, and pressing w will toggle the cycling on and off.<br>
Pressing r will instantly restart, and you also have a builtin timer so that you will always restart at the desired time.<br>
Pressing e will exit the curent round of tower testing and pressing t will toggle the stats to the Waves tab.

# Requirements
- 2 impulses
- 1 condition
- 16 actions
- 5 scripts

Avoid using Dynamic UI Scaling, the AI uses relative vectors which base their calculations around the UI scale, Dynamic UI Scaling leads to your UI scale being modified, but the value returned by the function does not get updated, resulting in the clicks not being made in the right places

# Source Code
The source code is a code you import into the [external AI editor](https://d0sboots.github.io/perfect-tower/) by [d0sboots](https://github.com/d0sboots/perfect-tower)
```
{"workspaces":{"Codrineye's TowerTesting":[["TowerTesting_lib","#package(name) Codrineye's TowerTesting:{name}\n\n#identifier \"Condineye's TowerTesting\"\n\n#hider concat(\"<size=0>\", \"Variable_Hider\") . {identifier}\n\n#state \"<size=0>\" . {identifier} . \"</size>\" . \"active\"\n#state_get global.bool.get({state})\n#state_toggle global.bool.set({state}, false == {state_get})\n\n#counting \"<size=0>\" . {identifier} . \"counting\"\n#counting_get global.int.get({counting})\n#counting_set(value) global.int.set({counting}, ({value}))\n#counting_increment {counting_set({counting_get} + 1)}\n\n#change_difficulty \"<size=0>\" . {identifier} . \"</size>\" . \"change_difficulty\"\n#change_difficulty_get global.bool.get({change_difficulty})\n#change_difficulty_set(value) global.bool.set({change_difficulty}, {value})\n\n#Region_Cycling {identifier} . \"</size>\" . \"Region_Cycling\"\n#Region_Cycling_get global.bool.get({Region_Cycling})\n\n#mode1 \"Difficulty>Region\" . \"</size>\"\n#mode2 \"Region>Difficulty\" . \"</size>\"\n\n:const double screen_delay 0.2\n:const int difficulty_spacing 5\n\n:const string difficulty1 '290.0'\n:const string difficulty2 '256.0'\n:const string difficulty3 '217.0'\n:const string difficulty4 '182.0'\n:const string difficulty5 '145.0'\n:const string difficulty6 '112.0'\n\n:const int difficulty_count 6\n\n#difficulty_list difficulty1 . difficulty2 . difficulty3 . difficulty4 . difficulty5 . difficulty6\n#inversed_difficulty_list difficulty6 . difficulty5 . difficulty4 . difficulty3 . difficulty2 . difficulty1\n\n"],["Stats Exit Diff_Change",":import TowerTesting_lib\n:name {package(Stats Exit Diff_Change)}\n\n:global double Curent_Diff\n:local int increment\n\nkey.t()\nkey.e()\n\nconcat(\"Easy -> Impossible\", {difficulty_list}) != \\\nconcat(\"Impossible -> Easy\", {inversed_difficulty_list})\n\ngoto(if(\\\n  contains(impulse(), \"{package()}\"), \\\n  loop, \\\n  if(\\\n    contains(impulse(), \"key.\"), \\\n    if(\\\n      isTowerTesting(), \\\n      if(contains(impulse(), \"key.t\"), stats, exit), \\\n      99\\\n    ), \\\n    wait_for_exit\\\n  )\\\n))\nwait_for_exit:\nwaitwhile(global.double.get(\"t\") % 60.0 > 0.5 || global.double.get(\"t\") < 0.5)\nexit:\nexit()\n\nstats:\nwait(screen_delay)\n{click.relative(230.0/800.0, 275.0/450.0, 0.5, 0.5)}\ngoto(99)\n\nloop:\nCurent_Diff = s2d(sub({difficulty_list}, increment * difficulty_spacing, difficulty_spacing), 290.0)\n\nincrement = (increment + 1) % difficulty_count\n\nwait(screen_delay)\nwaituntil({change_difficulty_get} || {state_get} == false)\n{change_difficulty_set(false)}\n\ngotoif(loop, {state_get})\n"],["Toggles",":import TowerTesting_lib\n:name {package(Toggles)}\n\n:global string CurentMode\n\nkey.q()\nkey.w()\n\ngotoif(initialized, {state_get})\nexecutesync(\"{package(Initialiser)}\")\ngoto(99)\n\ninitialized:\nglobal.bool.set(\\\n  {Region_Cycling}, \\\n  contains(\"key.q|{package(Initialiser)}\", impulse()) || {Region_Cycling_get} == false\\\n)\n\ngotoif(99, contains(impulse(), \"key.w\"))\nCurentMode = if(\\\n  contains(CurentMode, {mode1}) && false == contains(impulse(), \"{package()}\"), \\\n  {mode2}, \\\n  {mode1}\\\n)\n"],["Enter Region",":import TowerTesting_lib\n:name {package(Enter Region)}\n\n:global double Curent_Diff\n:global string CurentMode\n\n#condition1 contains(CurentMode, {mode2}) && {counting_get} == 14\n#condition2 contains(CurentMode, {mode1}) && {counting_get} < 6\n\ngotoif(if({state_get}, enter_difficulty, 99), {condition1} || {condition2})\ngotoif(enter_difficulty, false == {Region_Cycling_get})\n\nwaitwhile(isTowerTesting() || anyopen())\n\nshow(\"towertesting\", true)\nwait(screen_delay)\n{click.relative(290.0/800.0, 201.0/450.0, 0.0, 1.0)}\nwait(screen_delay)\n\nenter_difficulty:\nshow(\"towertesting\", true)\nwait(screen_delay)\n{click.relative(395.0/800.0, Curent_Diff/450.0, 0.0, 1.0)}\n\nwait(screen_delay)\n{click.relative(162.0/800.0, 97.0/450.0, 0.0, 1.0)}\n"],["Movement Manager",":import TowerTesting_lib\n:name {package(Movement Manager)}\n\n:global string CurentMode\n\n{counting_set(0)}\n{change_difficulty_set(false)}\n\nloop:\nwaitwhile({state_get} && (anyopen() || isTowerTesting() || CurentMode == \"\"))\nexecutesync(\"{package(Enter Region)}\")\n\n{counting_increment}\n{change_difficulty_set(contains(CurentMode, {mode1}))}\n\nwaitwhile({change_difficulty_get} && {state_get})\nwaituntil(anyopen() || isTowerTesting() || {state_get} == false)\ngotoif(\\\n  if({state_get}, loop, 99), \\\n  contains(CurentMode, {mode1}) && {counting_get} < 6 || \\\n  contains(CurentMode, {mode2}) && {counting_get} < 15\\\n)\nwaitwhile({state_get} && (anyopen() || isTowerTesting()))\nexecutesync(\"{package(Enter Region)}\")\n\n{counting_set(0)}\n{change_difficulty_set(contains(CurentMode, {mode2}))}\ngotoif(loop, {state_get})\n"],["Initialiser",":import TowerTesting_lib\n:name {package(Initialiser)}\n\nkey.x()\nkey.r()\n\ngotoif(\\\n  if(contains(impulse(), \"key.r\"), restart, timer), \\\n  contains(\"key.r|{package(Initialiser)}\", impulse())\\\n)\nglobal.string.set({hider}, if(\\\n  {state_get}, \\\n  \"Codrineye's TowerTesting Is Shutdown\", \\\n  concat(\"Hider Blocker\", \"</size>\")\\\n))\n\n{state_toggle}\ngoto(if({state_get}, skip, 99))\n\nskip:\nexecute(\"{package(Stats Exit Diff_Change)}\")\nexecute(\"{package(Movement Manager)}\")\nexecutesync(\"{package(Toggles)}\")\nwaitwhile({state_get} && anyopen() || isTowerTesting())\n\nloop:\nwaitwhile({state_get} && (isTowerTesting() == false))\nexecute(\"{package(Initialiser)}\")\nwaitwhile({state_get} && health(false) > 0.0 && (enemies() > 0 || wave() < 100.0))\nexit()\nstop(\"{package(Restart At Will)}\")\ngoto(if({state_get}, loop, 99))\n\ntimer:\nwait(30.0)\n\nrestart:\nrestart()\n\n"]]}}
```

# Import code
The import code is the code you import into the game
```
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
```

# Cod TT
Thank you bluecat for making an attempt to rework this mess

Cod TT is a version of Codrineye's TowerTesting made by bluecat, who tried to take my original idea and condense it into a more compact AI.<br>
While the attempt was great, and it lead to a functional product, it still has the same shortcomings my original AI had

```
{"workspaces":{"Cod TT":[["Tower_Automation lib","\n#package Codrineye's TowerTesting\n\n\n#init Init\n#logic Core\n#difficulty Difficulty Cycle\n#region Region Cycle\n#toggles QOL\n"],["init","\n:import Tower_Automation lib\n:name {package}:{init}\n\n:global bool CdTTRunning\n:global bool RegionCycle\n:global double ClickPos\n:global string difficultyClickPositions\n\n\n\nkey.x()\n\nstart:\ngss(\"OnName\", \"<color=#FF0000><b>PLEASE INPUT CUSTOM NAME IN HERE</b></color>\")\ngss(\"<size=0>\", \"##--STARTHIDING--##\")\nCdTTRunning = CdTTRunning == false ;starts true, if called again goes false and ends script\nRegionCycle = RegionCycle\nClickPos = ClickPos\ndifficultyClickPositions = \"112.0;145.0;182.0;217.0;256.0;290.0;</size><color=\" . if(CdTTRunning, \"#00FF00\", \"#FF0000\") . \">\" \ngss(gsg(\"OnName\") . if(false, \"\", \"<size=0>\"), \"</size></color><color=\" . if(RegionCycle, \"#FF0000\", \"#00FF00\"))\ngss(\"Cycle Region<size=0>\", \"</size>\")\nloop:\nexecutesync(\"{package}:{logic}\")\nwaituntil((tower.health(false) == 0.0) && isTowerTesting())\nexit()\ngotoif(loop, CdTTRunning)\ngu(gsg(\"OnName\"))"],["Instant Restart || Stats Button","\n:import Tower_Automation lib\n:name {package}:{toggles}\n\nkey.r() ;restart\nkey.t() ;stats\n\nisTowerTesting()\n\ngotoif(stats, impulse() == \"key.t\")\n\nrestart:\nrestart()\n\nstats:\n{click.relative(230.0/800.0, 275.0/450.0, 0.5, 0.5)}"],["Region Cycle Toggle || Region Move","\n:import Tower_Automation lib\n:name {package}:{region}\n\n:global bool CdTTRunning\n:global bool RegionCycle\n\nkey.w() ; toggle cycle\n\n\ngotoif(toggleCycle, contains(impulse(), \"key.\") || CdTTRunning == false)\n\nmoveRegion:\nwaitwhile(isTowerTesting() && RegionCycle)\ngotoif(99, RegionCycle == false)\nshow(\"towertesting\", true)\nwait(0.2)\n{click.relative(290.0/800.0, 201.0/450.0, 0.0, 1.0)}\nwait(0.2)\nshow(\"towertesting\", false)\ngoto(99)\n\ntoggleCycle:\nRegionCycle = (RegionCycle == false)\n"],["Difficulty Move || Auto Exit","\n:import Tower_Automation lib\n:name {package}:{difficulty}\n\n:global double ClickPos\n\ngame.newround()\nkey.e()\n\ngotoif(changeDiff, contains(impulse(), \"{package}\"))\n\nexit:\nwait(if(impulse() == \"game.newround\", 10.0, 0.0))\nexit()\ngoto(99)\n\nchangeDiff:\nshow(\"towertesting\", true)\nwait(0.2)\n{click.relative(395.0/800.0, ClickPos/450.0, 0.0, 1.0)}\nwait(0.2)\n{click.relative(162.0/800.0, 97.0/450.0, 0.0, 1.0)}\n"],["Movement Logic","\n:import Tower_Automation lib\n:name {package}:{logic}\n\n#subList sub(difficultyClickPositions, index, index(difficultyClickPositions, \";\", index) - index)\n\n:global double ClickPos\n:local int index\n:global string difficultyClickPositions\n\n\n\ngotoif(99, false)\nloop:\nwaitwhile(isTowerTesting()) \n; waits until the restart triggers from auto restart\n\nClickPos = s2d({subList}, 290.0) \n; sets the new position to go to diff\n    \nexecutesync(\"{package}:{difficulty}\") \n; runs position\n    \nindex = (index(difficultyClickPositions, \";\", index) + 1) \n; updates index to set up next click\n    \nwaituntil(isTowerTesting()) \n; run waituntil to make sure we get in TT before updating region if needed\n\nrepeat:\ngotoif(loop, {subList} != \"\") ; if next click is blank, list is over so lets restart\nexecutesync(\"{package}:{region}\") ; when there's no diffs start the region move\nlu(\"index\") ; remove this once I fix index\ngoto(loop)\n\n\n\n\n"]]}}
```
